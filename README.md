# Building Recommendation system using Rule Based method and Market Basket Analysis
## Business Overview 
With the rapid expansion of e-business platforms across various industries, both the volume of user data and the duration of user engagement have grown significantly. This heightened interaction has driven the adoption of personalized customer experiences, which play a vital role in enhancing customer retention and ultimately contribute to sustained long-term revenue growth for companies.Recommender systems helps companies deliver this personalized customer experiences,improve customer satisfaction, and drive key performance metrics like sales, engagement, and retention.Recommendation systems use sophisticated algorithms to process large volumes of data and filter it based on various factors such as a user's purchase history, preferences, business rules, and product similarities.

In "Rule Based" recommenders, various rules such as popularity of the products, new product launches, discount and offers are considered when making recommendations to users. 
"Market Basket Analysis" uses algorithms such as 'Apirori' to understand the purchase behavior of users ( frequently bought itemsets in the same transaction) using association rules and recommend frequent itemsets to future users. It suses metrics such as support, confidence and lift to determine which are the frequently bought itemsets.

## Project overview 
This project uses a commedities dataset to build recommendation systems based on the both rules based method and market basket analysis technique. 
## Data 
The dataset contains transactional data collected from online retail company that sells unique all occasion gifts which occured between 01/12/2010 and 09/12/2011. Dataset can be found in the [UCL machine learning repository](https://archive.ics.uci.edu/dataset/352/online+retail). It contains information about 500k+ customers over eight attributes which are InvoiceNo, StockCode, Description, Quantity, InvoiceDate, UnitPrice, CustomerID, Country.
## Exploratory Data Analysis(EDA) 
Several customer based and item based insights were gained from the EDA.
### Extracting Customer Insights from the dataset
1. The most loyal customers were from United Kingdom , top 10 loyal customers have made atleast 1600+ transactions and among them the top most loyal customer had made 7847 transactions.
2. The highest revenue generated by a single customer was approximately €280,000, originating from the Netherlands. The remaining customers in the top 10 category, were each contributing at least €77,000 in revenue and are from the United Kingdom, Australia, and Ireland (EIRE).
3. By observing the customer purchase patterns based on the seasonality,following insights were made as shown in the below imgaes :
   ![image1](Images/image1.png)
      ***Image 1*** : 
    There's a gradual increase in purchasing activity  from August through November, suggesting stronger user engagement during late fall months.The highest volume of purchases occurred in November 2011, indicating a possible seasonal or promotional effect and had hit the least volume in the December on the same year.

    ![image2](Images/image2.png)
      ***Image 2*** :
    There's a steady increase in purchases from Monday to Thursday, followed by a noticeable decline over the weekend. There were no orders were recorded on Saturdays, indicating minimal customer activity on that day.

   ![image3](Images/image3.png)
      ***Image 3*** :
   The revenue generated by products based on seasonality closely correlates with customer purchase patterns. Notably, the highest number of purchases occurred in November, which also coincided with the peak in revenue generation during the same month.
4. Considering the items with no unit prices as free items,
   ![image4](Images/image5.png)

   ***Image 3***: The highest number of free items was purchased in December 2010, followed by significant spikes in May and December of 2011. This trend suggests that free item purchases tend to peak during late spring and at the end of the year, possibly due to seasonal promotions or holiday campaigns.

### Extracting Items Insights from the dataset
1. The following image depicts the top 10 items bought by most customers. 
   ![image5](Images/image6.png)
   ***Image 5***: It shows there's the highest demand for the product 'regency cake stand 3tier'.

2. Based on the amount of sales made by the customers, the below image shows the top 10 most sold items based on the amount of sales.
   ![image6](Images/image7.png)
   ***Image 6***: The top 10 best-selling items each recorded over 26,000 units sold. Among them, the highest-selling item was 'Paper Craft, Little Birdie'
   
3. The below image shows the most ordered items.
   ![image7](Images/image8.png)
   ***Image 7***: This image shows the highest number of orders were made for the item 'cream hanging heart t-light holder' with an order count of 54.

    ![image8](Images/image9.png)

    ***Image 8***: The word cloud aligns with the insights presented in the previous plot, highlighting the most frequently ordered items.

5. Top 5 items that were the first choice by the customers are : 'PAINTED METAL PEARS ASSORTED','LUNCH BAG SPACEBOY DESIGN ','METAL DECORATION NAUGHTY CHILDREN', 'JUMBO BAG RED RETROSPOT' and 'VINTAGE DOILY DELUXE SEWING KIT ' .


## Implementation of Rule Based Recommendation Systems 
Recommendations were made using two types of rules in this project: 
1. Popularity based
2. Buy again( based on the purchase history of customers)

### Popularity Based Recommendations 
Given its global popularity, 'Paper Craft Little Birdie' can be recommended as a potential purchase item for new users.
![image9](Images/image10.png)

***Image 9***: Top 10 recommended products based on the Global popularity of the products 

The following image highlights the top recommended items across selected countries.
![image10](Images/image11.png) 

***Image 10***: The Top 110 recommended items based on the each Country 

### Recommendations based on the Purchase History 
Based on the purchase history of items, some of the top recommended items are : 'WHITE HANGING HEART T-LIGHT HOLDER','WHITE METAL LANTERN','CREAM CUPID HEARTS COAT HANGER','KNITTED UNION FLAG HOT WATER BOTTLE','RED WOOLLY HOTTIE WHITE HEART.'

## Implementation of Market Basket Analysis 
This method in recommendar systems identfy frequently bought itemsets by customers through calculating the likelihood of buying items together in the same transaction/basket.
With the use of Apiriori algorithm, on a dataframe that represents transactional data, where each row corresponds to a transaction and each column represents an item, it identifies the items co-occur in transactions and generate association rules. These association rules generates a dataframe with attributes antecedents, consequents and support, confidence and lift.
- antecedents : items on the left side of the rule
- consequents : items on the right side of the rule
- antecedent support : proportion of transactions contain antecedent
- consequent support : proportion of transactions contain consequent
- support : fraction of transactions contains both antecedents and consequents
- confidence: How often consequents appear in the transactions that contain antecedents
- lift : How likely consequents are to appear with antecedents than by random chance

The following function is defined to find the association rules from the co-relation between items and  recommend the top consequents for a selected item
```python 
def frequently_bought_together(item):
    # df of item passed
    item_df = basket.loc[basket[item]==1]
    frequent_itemsets=apriori(item_df,min_support=0.15,use_colnames=True)#Apply apriori algorithm on item df 
    rules=association_rules(frequent_itemsets,metric='lift',min_threshold=1)
    rules.sort_values(['lift','support'],ascending=False).reset_index(drop=True)
    return rules['consequents'].unique()[:6]
 ```
### Visualization of association rules 
The purpose of this plot is to visually identify how rules are formed together between items, which items are central to multiple rules to identify the frequently bought itemsets.
![image13](Images/bigraph1.png)

***Image 11*** : This plot shows the relationship between association rules and items (conseqquents) for the item ' JAM MAKING SET WITH JARS' when 6 rules are selected. It shows customers who bought this item also tend to buy to 'ROSES REGENCY TEACUPS AND SAUCER' as these two items are associated by three association rules R3, R5 and R4.

In this plot, green nodes represents the individual items and yellow nodes represents association rules which are labeled as R1, R2... etc. edges from green nodes to yellow nodes indicate that the item is part of the antecedent of the rule and edges from yellow to green nodes indicate that items are part of the consequents of the rule. Although edge thickness(weight) is set uniform in this plot, it could use to represent the strength of the rules. 

## Conclusion 
Recommender systems personalize user experiences by analyzing data like purchase history and preferences. Rule-based models use product popularity and promotions, while Market Basket Analysis applies algorithms like Apriori to find frequently bought itemsets. These systems boost customer satisfaction, engagement, and business growth.









